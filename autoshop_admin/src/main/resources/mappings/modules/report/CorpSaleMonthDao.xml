<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zhilai.master.modules.report.dao.CorpSaleMonthDao">
 	<resultMap type="com.zhilai.master.modules.report.entity.CorpSaleMonth" id="corpSaleMonthResultMap">
 		<id property="logid" column="logid" />
 		<result property="corp_id" column="corp_id" />
		<result property="corp_name" column="corp_name"/>
		<result property="order_num" column="order_num"/>
		<result property="wechat_num" column="wechat_num"/>
		<result property="app_num" column="app_num"/>
		<result property="terminal_num" column="terminal_num"/>
		<result property="product_num" column="product_num"/>
		<result property="refund_num" column="refund_num"/>
		<result property="abnormal_num" column="abnormal_num"/>
		<result property="sale_money" column="sale_money"/>
		<result property="refund_money" column="refund_money"/>
		<result property="rpt_date" column="rpt_date"/>
		<result property="rpt_day" column="rpt_day"/>
		<result property="rpt_month" column="rpt_month"/>
		<result property="rpt_year" column="rpt_year"/>
		<result property="create_time" column="create_time"/>
 	</resultMap>
 	
 	<select id="get" resultMap="corpSaleMonthResultMap">
		SELECT 
			*
		FROM as_corp_sale_month a
		WHERE a.logid = #{logid}
	</select>
	
	<select id="findList" resultMap="corpSaleMonthResultMap">
		SELECT 
			*
		FROM as_corp_sale_month  WHERE 1=1 
		
		<if test="rpt_month != null and rpt_month !=''">
			AND rpt_month=#{rpt_month}
		</if>
		<if test="rpt_year != null and rpt_year !=''">
			AND rpt_year=#{rpt_year}
		</if>
		<if test="corp_id != null and corp_id != '' ">
			AND corp_id =#{corp_id}
		</if>
		ORDER BY create_time DESC
	</select>
	
	<select id="findOne" resultMap="corpSaleMonthResultMap">
		SELECT * FROM as_corp_sale_month  WHERE rpt_month=#{rpt_month} AND rpt_year =#{rpt_year}
		<if test="corp_id != null and corp_id != '' ">
			AND corp_id =#{corp_id}
		</if>
	</select>

 </mapper> 
 	
