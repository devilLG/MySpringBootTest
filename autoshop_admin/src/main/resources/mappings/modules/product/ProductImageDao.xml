<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zhilai.master.modules.product.dao.ProductImageDao">
	<resultMap type="com.zhilai.master.modules.product.entity.ProductImage" id="productImageResultMap">
		<id property="logid" column="logid" />
		<result property="image_id" column="image_id" />
		<result property="corp_id" column="corp_id" />
		<result property="corp_name" column="corp_name" />
		<result property="product_id" column="product_id" />
		<result property="product_name" column="product_name" />
		<result property="chanel_type" column="chanel_type" />
		<result property="mime_type" column="mime_type" />
		<result property="image_url" column="image_url" />
		<result property="image_px" column="image_px" />
		<result property="image_width" column="image_width" />
		<result property="image_height" column="image_height" />
		<result property="create_time" column="create_time" />

	</resultMap>
	
	<select id="get" resultMap="productImageResultMap">
		SELECT 
			*
		FROM as_product_image a
		WHERE a.logid = #{logid}
	</select>
	
	<select id="findList" resultMap="productImageResultMap">
		SELECT 
			*
		FROM as_product_image a WHERE 1=1 
		<if test="product_id != null and product_id != ''">
			AND a.product_id = #{product_id}
		</if>
		<if test="corp_id != null and corp_id != ''">
			AND a.corp_id = #{corp_id}
		</if>
		ORDER BY a.chanel_type
	</select>
	
	<select id="findExist" resultMap="productImageResultMap">
		SELECT * FROM as_product_image a WHERE a.product_id=#{product_id} 
		AND a.corp_id = #{corp_id} AND a.chanel_type = #{chanel_type}
 		limit 0,1
	</select>
	
	<insert id="insert">
	   insert into as_product_image(logid,image_id,corp_id,corp_name,product_id,product_name,chanel_type,mime_type,image_url,image_px,image_width,image_height,create_time) 
	   values(#{logid},#{image_id},#{corp_id},#{corp_name},#{product_id},#{product_name},#{chanel_type},#{mime_type},#{image_url},#{image_px},#{image_width},#{image_height},#{create_time})
	</insert>
	
	<update id="update">
		update as_product_image set 
		corp_id=#{corp_id},
		corp_name=#{corp_name},
		product_id=#{product_id},
		product_name=#{product_name},
		chanel_type=#{chanel_type},
		mime_type=#{mime_type},
		image_url=#{image_url},
		image_px=#{image_px},
		image_width=#{image_width},
		image_height=#{image_height}
		where logid=#{logid}
	</update>
	
	<delete id="delete">
		delete from as_product_image where product_id=#{product_id}
	</delete>
	
</mapper> 
 	
