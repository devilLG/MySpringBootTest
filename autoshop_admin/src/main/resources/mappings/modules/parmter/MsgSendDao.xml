<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zhilai.master.modules.parmter.dao.MsgSendDao">
	<resultMap type="com.zhilai.master.modules.parmter.entity.MsgSend" id="msgSendResultMap">
		<id property="logid" column="logid" />
		<result property="corp_id" column="corp_id" />
		<result property="corp_name" column="corp_name"/>
		<result property="notice_obj" column="notice_obj"/>
		<result property="notice_key" column="notice_key"/>
		<result property="notice_type" column="notice_type"/>
		<result property="notice_way" column="notice_way"/>
		<result property="cont" column="cont"/>
		<result property="plan_time" column="plan_time"/>
		<result property="fail_num" column="fail_num"/>
		<result property="proc_flag" column="proc_flag"/>
		<result property="proc_time" column="proc_time"/>
		<result property="create_time" column="create_time"/>
	</resultMap>
	
	<select id="findList" resultMap="msgSendResultMap">
		select * from as_msg_send t where 1=1
		<if test="proc_flag != null and proc_flag != '' ">
			AND t.proc_flag=#{proc_flag}
		</if>
		order by t.create_time
	</select>
	
	<select id="findWarnList" resultMap="msgSendResultMap">
		select * from as_msg_send t where 1=1
		<if test="corp_id != null and corp_id != '' ">
			AND t.corp_id=#{corp_id}
		</if>
		order by t.create_time limit 0,10
	</select>
	
	<insert id="insert">
		INSERT INTO
		as_msg_send(logid,corp_id,corp_name,notice_obj,notice_key,notice_type,notice_way,cont,plan_time,fail_num,proc_flag,proc_time,create_time)
		VALUES(#{logid},#{corp_id},#{corp_name},#{notice_obj},#{notice_key},#{notice_type},#{notice_way},#{cont},#{plan_time},#{fail_num},#{proc_flag},#{proc_time},#{create_time});
	</insert>
	
	<update id="update">
		update as_msg_send set fail_num=#{fail_num},proc_flag=#{proc_flag},proc_time=#{proc_time}
		where logid=#{logid}
	</update>
</mapper>
