<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zhilai.master.modules.broadcast.dao.AdvertAreaMediaDao">
	
	<select id="get" resultType="AdvertAreaMedia">
		SELECT 
			* 
		FROM as_advert_area_media 
		WHERE logid = #{logid}
	</select>
	
	<select id="findList" resultType="AdvertAreaMedia">
		SELECT 
			* 
		FROM as_advert_area_media  
		WHERE 1=1
		<if test="areaId != null and areaId != ''">
			AND area_id = #{areaId} 
		</if>
		<if test="mediaId != null and mediaId != ''">
			AND media_id = #{mediaId} 
		</if>
		<if test="configId != null and configId != ''">
			AND config_id = #{configId} 
		</if>
		<if test="configName != null and configName != ''">
			AND (config_name = #{configName} OR config_name LIKE 
				<if test="dbName == 'oracle'">'%'||#{configName}||'%')</if>
				<if test="dbName == 'mssql'">'%'+#{configName}+'%')</if>
				<if test="dbName == 'mysql'">CONCAT('%', #{configName}, '%'))</if>
		</if>
		<if test="mimeType != null and mimeType != ''">
			AND mime_type = #{mimeType} 
		</if>
		ORDER BY state_time DESC, create_time DESC
	</select>
	

  	<insert id="insert">
		INSERT INTO as_advert_area_media(
			logid,
			play_id,
			area_id, 
			area_name, 
			config_id, 
			config_name, 
			media_type,
			mime_type,
			media_id,
			media_address,
			media_size,
			media_time,
			media_seq,
			cur_state,
			state_time,
			create_time
		) VALUES (
			#{logid},
			#{playId},
			#{areaId}, 
			#{areaName},
			#{configId}, 
			#{configName},
			#{mediaType},
			#{mimeType},
			#{mediaId},
			#{mediaAddress},
			#{mediaSize},
			#{mediaTime},
			#{mediaSeq},
			#{curState},
			#{stateTime},
			#{createTime}
		)
	</insert>
	
 
 	<update id="update">
		update as_advert_area_media set 
		cur_state=#{curState},
		state_time=#{stateTime}
		where logid=#{logid}
	</update>
		

	
 	<delete id="delete">
		delete from as_advert_area_media where logid=#{logid}
	</delete>
</mapper>