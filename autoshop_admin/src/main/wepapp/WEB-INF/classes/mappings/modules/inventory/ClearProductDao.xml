<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zhilai.master.modules.inventory.dao.ClearProductDao">
	<resultMap type="com.zhilai.master.modules.inventory.entity.ClearProduct" id="clearProductResultMap">
		<id property="logid" column="logid" />
		<result property="order_id" column="order_id" />
		<result property="torder_id" column="torder_id" />
		<result property="corp_id" column="corp_id" />
		<result property="corp_name" column="corp_name" />
		<result property="site_id" column="site_id" />
		<result property="site_name" column="site_name" />
		<result property="box_id" column="box_id" />
		<result property="product_id" column="product_id" />
		<result property="product_name" column="product_name" />
		<result property="bar_code" column="bar_code" />
		<result property="clear_num" column="clear_num" />
		<result property="inventory_num" column="inventory_num" />
		<result property="clear_id" column="clear_id" />
		<result property="clear_name" column="clear_name" />
		<result property="clear_date" column="clear_date" />
		<result property="create_time" column="create_time" />
	</resultMap>
	
	<select id="get" resultMap="clearProductResultMap">
		SELECT 
			*
		FROM as_clear_product a
		WHERE a.logid = #{logid}
	</select>
	
	<select id="findList" resultMap="clearProductResultMap">
		SELECT 
			*
		FROM as_clear_product a WHERE 1=1 
		<if test="clear_name != null and clear_name != ''">
			AND a.clear_name like 
					<if test="dbName == 'oracle'">'%'||#{clear_name}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{clear_name}+'%'</if>
					<if test="dbName == 'mysql'">CONCAT('%', #{clear_name}, '%')</if>
		</if>
		<if test="site_id != null and site_id != ''">
			AND a.site_id = #{site_id}
		</if>
		<if test="corp_id != null and corp_id != ''">
			AND a.corp_id = #{corp_id}
		</if>
		<if test="beginTime != null and beginTime != '' ">
			and a.clear_date >= #{beginTime}
		</if>
		<if test="endTime != null and endTime != '' ">
			and a.clear_date <![CDATA[< ]]>DATE_ADD(#{endTime}, INTERVAL 1 DAY) 
		</if>
		ORDER BY a.create_time DESC
	</select>

	<insert id="insert">
		insert into
		as_clear_product(logid,order_id,torder_id,corp_id,corp_name,site_id,site_name,box_id,product_id,product_name,bar_code,clear_num,inventory_num,clear_id,clear_name,clear_date,create_time)
		values(#{logid},#{order_id},#{torder_id},#{corp_id},#{corp_name},#{site_id},#{site_name},#{box_id},#{product_id},#{product_name},#{bar_code},#{clear_num},#{inventory_num},#{clear_id},#{clear_name},#{clear_date},#{create_time})
	</insert>
	
	<insert id="update">
		update as_clear_product set box_id=#{box_id},product_id=#{product_id},product_name=#{product_name},bar_code=#{bar_code},clear_num=#{clear_num},inventory_num=#{inventory_num},clear_id=#{clear_id},clear_name=#{clear_name},clear_date=#{clear_date},create_time=#{create_time}
		where logid=#{logid}
	</insert>
	
	<delete id="delete">
	    delete from as_clear_product where order_id=#{order_id}
	</delete>
</mapper>