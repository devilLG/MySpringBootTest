<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zhilai.master.modules.site.dao.SiteGoodsDao">
 	<resultMap type="com.zhilai.master.modules.site.entity.SiteGoods" id="SiteGoodsResultMap">
 		<id property="logid" column="logid" />
 		<result property="goods_id" column="goods_id" />
 		<result property="corp_id" column="corp_id" />
 		<result property="corp_name" column="corp_name" />
		<result property="site_id" column="site_id" />
		<result property="site_name" column="site_name"/>
		<result property="cabinet_id" column="cabinet_id"/>
		<result property="cloumn_id" column="cloumn_id"/>
		<result property="layer_num" column="layer_num"/>
		<result property="box_id" column="box_id"/>
		<result property="box_type" column="box_type"/>
		<result property="temper_type" column="temper_type"/>
		<result property="state_time" column="state_time"/>
		<result property="cur_state" column="cur_state"/>
		<result property="down_state" column="down_state"/>
		<result property="down_time" column="down_time"/>
		<result property="create_time" column="create_time"/>
 	</resultMap>
 	
 	<select id="get" resultMap="SiteGoodsResultMap">
		SELECT 
			*
		FROM as_site_goods a
		WHERE a.logid = #{logid}
	</select>
	
	<select id="findList" resultMap="SiteGoodsResultMap">
		SELECT 
			*
		FROM as_site_goods a WHERE 1=1 
		<if test="site_id != null and site_id != ''">
			AND a.site_id like 
					<if test="dbName == 'oracle'">'%'||#{site_id}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{site_id}+'%'</if>
					<if test="dbName == 'mysql'">CONCAT('%', #{site_id}, '%')</if>
		</if>
		<if test="site_name != null and site_name != ''">
			AND a.site_name like 
					<if test="dbName == 'oracle'">'%'||#{site_name}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{site_name}+'%'</if>
					<if test="dbName == 'mysql'">CONCAT('%', #{site_name}, '%')</if>
		</if>
		<if test="cur_state != null and cur_state != ''">
			AND a.cur_state like 
					<if test="dbName == 'oracle'">'%'||#{cur_state}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{cur_state}+'%'</if>
					<if test="dbName == 'mysql'">CONCAT('%', #{cur_state}, '%')</if>
		</if>
		<if test="logid != null and logid != ''">
			AND a.logid = #{logid}
		</if>
		<if test="corp_id != null and corp_id != ''">
			AND a.corp_id = #{corp_id}
		</if>
		<if test="temper_type != null and temper_type != ''">
			AND a.temper_type = #{temper_type}
		</if>
		<if test="box_id != null and box_id != ''">
			AND a.box_id = #{box_id}
		</if>
		<if test="box_ids != null and box_ids != ''">
		AND a.box_id not in 
		<foreach collection="box_ids" item="box_ids"  open="(" separator="," close=")">  
        		#{box_ids}  
     	</foreach>  
		</if>
		ORDER BY a.site_id,a.box_id
	</select>
	
	<select id="findOne" resultMap="SiteGoodsResultMap">
		SELECT 
			*
		FROM as_site_goods a WHERE 1=1
		<if test="site_id != null and site_id != ''">
			AND a.site_id = #{site_id}
		</if>
		<if test="box_id != null and box_id != ''">
			AND a.box_id = #{box_id}
		</if>
	</select>
	
	<delete id="delete">
		delete from as_site_goods where logid=#{logid}
	</delete>
	<delete id="deleteBysid">
		delete from as_site_goods where site_id = #{site_id}
	</delete>
	<select id="findBySiteId" parameterType="String" resultMap="SiteGoodsResultMap" >
       select * from as_site_goods where site_id=#{site_id} order by box_id  desc
	</select>
	<delete id="deleteByCabinetId"> parameterType="com.zhilai.master.modules.site.entity.SiteGoods"
		DELETE FROM as_site_goods where site_id=#{site_id} and cabinet_id=#{cabinet_id}  
	</delete>
	<insert id="insert">
			INSERT INTO as_site_goods(logid,goods_id,corp_id,corp_name,site_id,site_name,cabinet_id,cloumn_id,layer_num,box_id,box_type,temper_type,state_time,cur_state,
			down_state,down_time,create_time)
			values(#{logid},#{goods_id},#{corp_id},#{corp_name},#{site_id},#{site_name},#{cabinet_id},#{cloumn_id},#{layer_num},#{box_id},#{box_type},#{temper_type},#{state_time},#{cur_state},
			#{down_state},#{down_time},#{create_time})
	</insert>
	<update id="update">
		update as_site_goods set goods_id=#{goods_id},corp_id=#{corp_id},corp_name=#{corp_name},site_id=#{site_id},
		site_name=#{site_name},cabinet_id=#{cabinet_id},cloumn_id=#{cloumn_id},layer_num=#{layer_num},box_id=#{box_id},box_type=#{box_type},temper_type=#{temper_type},state_time=#{state_time},
		cur_state=#{cur_state},down_state=#{down_state},down_time=#{down_time},create_time=#{create_time}
		where logid=#{logid}
	</update>
	
 </mapper> 
 	
