<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zhilai.master.modules.inventory.dao.ReplenishmentOrderDao">
	<resultMap type="com.zhilai.master.modules.inventory.entity.ReplenishmentOrder" id="replenishmentOrderResultMap">
		<id property="logid" column="logid" />
		<result property="order_id" column="order_id" />
		<result property="torder_id" column="torder_id" />
		<result property="corp_id" column="corp_id" />
		<result property="corp_name" column="corp_name" />
		<result property="site_id" column="site_id" />
		<result property="site_name" column="site_name" />
		<result property="replen_num" column="replen_num" />
		<result property="replen_box" column="replen_box" />
		<result property="replen_product" column="replen_product" />
		<result property="lack_num" column="lack_num" />
		<result property="lack_box" column="lack_box" />
		<result property="lack_product" column="lack_product" />
		<result property="replen_date" column="replen_date" />
		<result property="replener_id" column="replener_id" />
		<result property="replener_name" column="replener_name" />
		<result property="cur_state" column="cur_state" />
		<result property="order_type" column="order_type" />
		<result property="state_time" column="state_time" />
		<result property="create_time" column="create_time" />
	</resultMap>

   <select id="get" resultMap="replenishmentOrderResultMap">
		SELECT 
			*
		FROM as_replenishment_order a
		WHERE a.logid = #{logid}
	</select>
	
	<select id="findList" resultMap="replenishmentOrderResultMap">
		SELECT 
			*
		FROM as_replenishment_order a WHERE 1=1 
		<if test="replener_name != null and replener_name != ''">
			AND a.replener_name like 
					<if test="dbName == 'oracle'">'%'||#{replener_name}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{replener_name}+'%'</if>
					<if test="dbName == 'mysql'">CONCAT('%', #{replener_name}, '%')</if>
		</if>
		<if test="site_id != null and site_id != ''">
			AND a.site_id = #{site_id}
		</if>
		<if test="beginTime != null and beginTime != '' ">
			and a.replen_date >= #{beginTime}
		</if>
		<if test="endTime != null and endTime != '' ">
			and a.replen_date <![CDATA[< ]]>DATE_ADD(#{endTime}, INTERVAL 1 DAY) 
		</if>
		<if test="corp_id != null and corp_id != ''">
			AND a.corp_id = #{corp_id}
		</if>
		<if test="cur_state != null and cur_state != ''">
			AND a.cur_state = #{cur_state}
		</if>
		ORDER BY a.state_time DESC
	</select>

	<insert id="insert">
		insert into
		as_replenishment_order(logid,order_id,torder_id,corp_id,corp_name,site_id,site_name,replen_num,replen_box,replen_product,lack_num,lack_box,lack_product,replen_date,replener_id,replener_name,cur_state,order_type,state_time,create_time)
		values(#{logid},#{order_id},#{torder_id},#{corp_id},#{corp_name},#{site_id},#{site_name},#{replen_num},#{replen_box},#{replen_product},#{lack_num},#{lack_box},#{lack_product},#{replen_date},#{replener_id},#{replener_name},#{cur_state},#{order_type},#{state_time},#{create_time})
	</insert>
	
	<insert id="update">
		update as_replenishment_order set torder_id=#{torder_id},corp_id=#{corp_id},corp_name=#{corp_name},site_id=#{site_id},site_name=#{site_name},replen_num=#{replen_num},replen_box=#{replen_box},replen_product=#{replen_product},lack_num=#{lack_num},lack_box=#{lack_box},lack_product=#{lack_product},replen_date=#{replen_date},replener_id=#{replener_id},replener_name=#{replener_name},cur_state=#{cur_state},order_type=#{order_type},state_time=#{state_time},create_time=#{create_time}
		where logid=#{logid}
	</insert>
	
	<delete id="delete">
	    delete from as_replenishment_order where logid=#{logid}
	</delete>
</mapper>