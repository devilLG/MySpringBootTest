<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zhilai.master.modules.log.dao.AccessLogDao">
 	<resultMap type="com.zhilai.master.modules.log.entity.AccessLog" id="AccessLogResultMap">
 		<id property="log_id" column="log_id" />
		<result property="access_time" column="access_time" />
		<result property="auth_name" column="auth_name" />
		<result property="auth_id" column="auth_id" />
		<result property="ip_addr" column="ip_addr" />
		<result property="hostname" column="hostname" />
		<result property="state" column="state" />
		<result property="protocol" column="protocol" />
 	</resultMap>
    
	<select id="get" resultMap="AccessLogResultMap">
		SELECT  *  FROM as_access_log WHERE  log_id = #{log_id}
	</select>
	
	<select id="findList" resultMap="AccessLogResultMap">
		SELECT log_id,	access_time,auth_name,auth_id,ip_addr,hostname,	state,	protocol
		FROM
		as_access_log t where 1=1
		<if test="access_time != null and access_time != '' ">
			AND t.access_time  >= CONCAT(#{access_time},' 00:00:00')
		</if>
		<if test="access_time_end != null and access_time_end != '' ">
			AND t.access_time <![CDATA[< ]]>DATE_ADD(CONCAT(#{access_time_end},' 00:00:00'), INTERVAL 1 DAY)
		</if>		
		<if test="auth_name != null and auth_name != '' ">
			AND t.auth_name = #{auth_name}
		</if>
		<if test="auth_id != null and auth_id != '' ">
			AND t.auth_id = #{auth_id}
		</if>
		order by access_time desc
	</select>
	<insert id="insert">
		INSERT INTO as_access_log
		(log_id,access_time,auth_name,auth_id,ip_addr,hostname,	state,	protocol	)
		VALUES
		(#{log_id},#{access_time},
		#{auth_name},#{auth_id},#{ip_addr},	#{hostname},#{state},#{protocol})
	</insert>
</mapper>