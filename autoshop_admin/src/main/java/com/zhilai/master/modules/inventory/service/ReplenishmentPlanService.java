package com.zhilai.master.modules.inventory.service;	import org.apache.commons.putils.utils.DateUtil;import org.apache.commons.putils.utils.StringUtils;import org.springframework.stereotype.Service;import org.springframework.transaction.annotation.Transactional;import com.zhilai.master.common.service.CrudService;import com.zhilai.master.common.utils.IdGen;import com.zhilai.master.modules.inventory.dao.ReplenishmentPlanDao;import com.zhilai.master.modules.inventory.entity.ReplenishmentPlan;import com.zhilai.master.modules.sys.entity.User;import com.zhilai.master.modules.utils.GParameter;	@Service@Transactional(readOnly=true)public class ReplenishmentPlanService extends CrudService<ReplenishmentPlanDao, ReplenishmentPlan> {		@Transactional	public void save(ReplenishmentPlan entity, User user) {		if (StringUtils.isBlank(entity.getPlanId())) {			entity.setLogid(IdGen.uuid());			entity.setPlanId(System.nanoTime() + "");			entity.setCorpId(user.getCorpId());			entity.setCorpName(user.getCompanyName());			entity.setCurState(GParameter.Cur_state_normal);			entity.setStateTime(DateUtil.getNow());			entity.setCreateTime(DateUtil.getNow());			if (entity.getPlanType().equals(GParameter.planType_site)) {				entity.setTargetId(entity.getSite_id());				entity.setTargetName(entity.getSite_name());			}else {				entity.setTargetId(entity.getArea_code());				entity.setTargetName(entity.getArea_name());			}			dao.insert(entity);		}else {			entity.setStateTime(DateUtil.getNow());			if (entity.getPlanType().equals(GParameter.planType_site)) {				entity.setTargetId(entity.getSite_id());				entity.setTargetName(entity.getSite_name());			}else {				entity.setTargetId(entity.getArea_code());				entity.setTargetName(entity.getArea_name());			}			dao.update(entity);		}	}}